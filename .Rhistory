ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),
main="Series X",xlab="Lag",ylab="ACF")
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red")
lines(c(1,1),c(0,autocov(1,theta)),col="red")
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue")
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue")
legend(1.7,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),
main="Series X",xlab="Lag",ylab="ACF")
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red")
lines(c(1,1),c(0,autocov(1,theta)),col="red")
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue")
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue")
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),
main="Series X",xlab="Lag",ylab="ACF")
axis(at = 1)
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red")
lines(c(1,1),c(0,autocov(1,theta)),col="red")
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue")
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue")
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
axis(at=seq(0,2,by=1))
axis(at=seq(0,2,by=1),las=2)
axis(1,at=seq(0,2,by=1),las=2)
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1),las=2)
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red")
lines(c(1,1),c(0,autocov(1,theta)),col="red")
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue")
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue")
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n"
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1),las=2)
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red")
lines(c(1,1),c(0,autocov(1,theta)),col="red")
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue")
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue")
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n"
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1),las=2)
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n"
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1),las=2)
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red")
lines(c(1,1),c(0,autocov(1,theta)),col="red")
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue")
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue")
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n"
main="Series X",xlab="Lag",ylab="ACF")
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1),las=2)
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red")
lines(c(1,1),c(0,autocov(1,theta)),col="red")
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue")
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue")
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
axis(1,at=seq(0,2,by=1))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red")
lines(c(1,1),c(0,autocov(1,theta)),col="red")
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue")
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue")
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=2)
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.1,0.1),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=0.01))
lines(c(1.1,1.1),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=2)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=2)
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue",lwd=2)
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue",lwd=2)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.035,0.035),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.035,1.035),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=2)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=2)
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue",lwd=2)
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue",lwd=2)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.01,0.01),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.01,1.01),c(0,autocov(1,theta)))
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=2)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=2)
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue",lwd=2)
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue",lwd=2)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.01,0.01),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",lwd=2,
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.01,1.01),c(0,autocov(1,theta)),lwd=2)
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=2)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=2)
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue",lwd=2)
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue",lwd=2)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.01,0.01),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",lwd=2,
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.01,1.01),c(0,autocov(1,theta)),lwd=2)
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=3)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=3)
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue",lwd=2)
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue",lwd=2)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.02,0.02),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",lwd=2,
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.02,1.02),c(0,autocov(1,theta)),lwd=2)
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=3)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=3)
lines(c(0.2,0.2),c(0,autocov(0,1/theta_est)),col="blue",lwd=2)
lines(c(1.2,1.2),c(0,autocov(1,1/theta_est)),col="blue",lwd=2)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.02,0.02),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",lwd=2,
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.02,1.02),c(0,autocov(1,theta)),lwd=2)
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=3)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=3)
lines(c(0.04,0.04),c(0,autocov(0,1/theta_est)),col="blue",lwd=2)
lines(c(1.04,1.04),c(0,autocov(1,1/theta_est)),col="blue",lwd=2)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
plot(c(0.02,0.02),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",lwd=3,
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.02,1.02),c(0,autocov(1,theta)),lwd=3)
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=3)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=3)
lines(c(0.04,0.04),c(0,autocov(0,1/theta_est)),col="blue",lwd=3)
lines(c(1.04,1.04),c(0,autocov(1,1/theta_est)),col="blue",lwd=3)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
autocov(0,1/theta_est)
theta=1.5
# [7. ] -------------------------------------------------------------------
autocov = function(k,theta){
ans=rep(0,length(k))
for (i in length(k)){
if (k[i]==0){
ans[i]=(1+1/theta^2)
}
else if (k[i]==1 || k[i]==-1){
ans[i]=(1/theta)
}
else{
ans[i]=0
}
return(ans)
}
}
theta=2
plot(c(0.02,0.02),c(0,autocov(0,theta)),type="l",xlim=c(0,2),ylim=c(0,2),xaxt="n",lwd=3,
main="Series X",xlab="Lag",ylab="ACF")
axis(1,at=seq(0,2,by=1))
lines(c(1.02,1.02),c(0,autocov(1,theta)),lwd=3)
theta=1.5
lines(c(0,0),c(0,autocov(0,theta)),col="red",lwd=3)
lines(c(1,1),c(0,autocov(1,theta)),col="red",lwd=3)
lines(c(0.04,0.04),c(0,autocov(0,1/theta_est)),col="blue",lwd=3)
lines(c(1.04,1.04),c(0,autocov(1,1/theta_est)),col="blue",lwd=3)
legend(1.71,2,legend=c(TeX('$\\theta = 1.5$'),TeX('$\\theta = 2$'),TeX('$\\hat{\\theta} \\approx 2.5 $')),fill=c("red","black","blue"))
Box.test(X,1)
acf(X)
Box.test(X,type="Ljung",lag=1,fitdf=1)
X[i]=arima.sim(c(0,0,0),1) + X[i-1]/theta
X=rep(0,2000);
for (i in 2:2000){
X[i]=arima.sim(list=c(0,0,0),1) + X[i-1]/theta
}
X=rep(0,2000);
for (i in 2:2000){
X[i]=arima.sim(list(ar=0,ma=0),1) + X[i-1]/theta
}
for (i in 2:2000){
X[i]=arima.sim(n=1,list(ar=0,ma=0)) + X[i-1]/theta
}
warnings()
arima.sim(n=1,list(ar=0,ma=0))
ts(arima.sim(n=1,list(ar=0,ma=0)))
for (i in 2:2000){
X[i]=arima.sim(n=1,list()) + X[i-1]/theta
}
X=rep(0,2000);
for (i in 2:2000){
X[i]=arima.sim(n=1,list()) + X[i-1]/theta
}
X=ts(X)
plot(ts(X))
# [5. ] -------------------------------------------------------------------
sigma=1
theta=2
X=rep(0,2000);
for (i in 2:2000){
X[i]=rnorm(1,mean=0,sd=sigma) + X[i-1]/theta
}
X=ts(X)
plot(ts(X))
sigma=1
theta=2
X=rep(0,2000);
for (i in 2:2000){
X[i]=arima.sim(n=1,list()) + X[i-1]/theta
}
X=ts(X)
plot(ts(X))
# [5. ] -------------------------------------------------------------------
theta=2
X=rep(0,2000);
for (i in 2:2000){
X[i]=arima.sim(n=1,list()) + X[i-1]/theta
}
X=ts(X)
plot(ts(X))
# [5. ] -------------------------------------------------------------------
theta=2
X=rep(0,2000);
for (i in 2:2000){
X[i]=arima.sim(n=1,list()) + X[i-1]/theta
}
X=ts(X)
plot(ts(X))
source('E:/Universite de Genève/Faculté d\'économie/Mon Master en statistique/A1S1/The Statistical Analysis of Time Series/TS_Project/Numerical Exercise.R', echo=TRUE)
